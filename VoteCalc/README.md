# 面向赛事主办者的机器人说明手册

## 背景
在 [议案](https://discord.com/channels/1134557553011998840/1373317241113935872) 中，讨论到了基于评价数统计的排名方案，易受
刷票等手段的影响，且任何人都可以进行评价， DC 并没有对此做出限制。

为了降低这方面的影响，上面的议案提出了一种新的计票方式，也就是本文即将描述的计票方式。

## 太长不看(TL;DR)
在比赛策划过程中，主办方需要在赛事说明中提供下面的信息：
1. 是否使用 Bot 进行评价统计：（必填）
2. 有效评价至少要参与几个作品的评价(N)：（默认3）
3. 权重信息：（默认全部为1权重，json形式配置）,
4. 检测的评价类别：（默认无限制，如果有多个，以逗号分隔，配置后仅统计指定的评价，如只统计 👍 ）

提供了这些信息后，在赛事结束后，会自动/由赛事人员手动推送给赛事主办方赛事排名的信息，内容形式如下：

-# 免责声明：下面的信息来自已结束的百破杯赛事，不代表比赛结束时的状态，不视为真实结果，因为统计使用的 N 为 1，所以比例始终为 100。
```
N: 1
权重: {"黑百合": 3,"创作者": 1.5,"赛博议员": 2, "已验证": 1.01}
====
• 帖子 '【纯爱/九尾狐妖/姐妹/熟女/御姐/主仆/淫纹/泌乳/调教/雌竟/百破杯/返璞归真杯】与妖媚九尾狐妖双子的日常 5.3更新喵!'
最高表情 👍 × 333，有效评价 333 人，加权后 361.47 分，比例 [100%]
• 帖子 '【百破杯】【5/9更新《我怎么可能成为你的恋人不行不行》dlc人物】【校园/ntl/女绿/师生】私立圣华女子学院～作为女校里的心理医生/体育老师/保健医生，开始狩猎吧'
最高表情 👍 × 183，有效评价 183 人，加权后 205.57 分，比例 [100%]
• 帖子 '5.3更新开局、COT【百破杯/百合破坏/ntl/乱伦/巨乳/后宫】女王和养女的女朋友们竟然是帝国派来的间谍情侣!'
最高表情 👍 × 132，有效评价 132 人，加权后 149.59 分，比例 [100%]
• 帖子 '5.16 更新蒸馏版2.0（面向0417） [百破杯/高达/NTL/娘化/同人魔改]关于天降神秘男开着海牛高达欺负学园美少女这件事《机动战士高达 水星的魔女》同人'
最高表情 👍 × 112，有效评价 112 人，加权后 135.79 分，比例 [100%]
.....略.....
======
角色权重分布
• 已验证: 701 人
• 创作者: 73 人
• 赛博议员: 40 人
• 黑百合: 9 人
• 默认: 2 人
```
这些信息会自动按照加权有效评价排名，主办方可以根据这个信息，来整理宣布比赛的最终结果。

## 以 有效评价 为基础的计票方式
对于一个赛事而言，它的参与者不仅仅是提交作品的创作者们，还有给那些作品给出中肯评价的鉴赏家，以及 已验证 成员。一个关心当前赛事的成员，必然会对不止一个作品进行游玩和评价。因此这种评价的数量即可成为一个检验机制，也就是“真正在意这个赛事的人，肯定会玩不止一个角色卡，对不止一个作品进行评价”，也就是下面的方案：

 - 为了简化说明，后续文本中通过 “赞” 来指代 “最高评价类别”
 - 有效评价 与 有效的赞 是同义词

0. 赛事举办方需要配置数值 `N`，作为最少所需的赞数。
1. 一个用户必须要对参赛作品中的至少 `N` 个进行赞后，TA 的赞才是有效的，才会计入最终的统计。
2. 最终统计时，会按照有效的赞进行排名。
3. 主办方可以设置只有特定的评价类别是有效的，即 “检测的评价类别”。
4. 主办方可以给不同的用户组，设置不同的权重，比如主办方对之前的 尖耳杯 比赛有好感，可以将持有 `尖耳朵` 的用户的 1 评价实际算作 2 评价。

### 例子
主办方 “暮莲” 主办了赛事 “MVU杯”，进行了下面的参数配置：
1. 是否使用 Bot 进行评价统计：是
2. 有效评价至少要参与几个作品的评价：2（默认3）
3. 权重信息：{"创作者": 1.25, "尖耳朵": 2, "已验证": 1},
4. 检测的评价类别："♥,🎴"

进行评价的用户有三个：
1. Alpha(创作者,已验证)
2. Beta(尖耳朵,已验证)
3. Gamma(已验证)
4. Delta(已验证)

参赛作品有三个：
1. 喵 评价：   👍*3(Alpha, Beta, Gamma), ♥*1(Alpha)
2. 汪 评价：   ♥*2(Beta, Delta)
3. 呜 评价：   ♥*3(Alpha, Beta, Gamma, Delta)
4. Honk 评价： ♥*2(Alpha, Delta)

根据上面的结果，实际只有下面用户的评价是有效的
1. Alpha（3次评价）
2. Beta（2次评价）
3. Delta（3次评价）

而 Gamma 因为只评价了一个作品，因此不会被计入。

因此最终的排名结果为
1. 呜   - 有效评价：4.25 = 2(Beta) + 1.25(Alpha) + 1(Delta)
2. 汪   - 有效评价：3 = 2(Beta) + 1(Delta)
3. Honk - 有效评价：2.25 = 1.25(Alpha) + 1(Delta)
4. 喵   - 有效评价：1.25 = 1.25(Alpha)

## 如有任何疑问，请在赛事的申请中 @MagicalAstrogy